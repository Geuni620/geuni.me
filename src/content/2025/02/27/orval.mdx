---
date: "2025-02-27"
title: "Orval"
category: ["ê°œë°œ"]
summary: "Orval"
---

import { SideNote } from "@/components/layout";

ìš°ì—°íˆ ë‹¨í†¡ë°©ì—ì„œ [Orval](https://orval.dev/)ì˜ ì¡´ì¬ë¥¼ ì•Œê²Œë˜ì—ˆë‹¤.  
Orvalì˜ ì¡´ì¬ë¥¼ ì•Œê¸° ì „ì— [OAS generator](https://hmos.dev/how-to-use-oas-generator)ì— ëŒ€í•´ì„œëŠ” ì¸ì§€í•˜ê³  ìˆê¸´í–ˆì§€ë§Œ, ì´ë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì„ì§€ëŠ” ë§‰ë§‰í•œ ìƒíƒœì˜€ë‹¤.
í•˜ì§€ë§Œ Orvalì˜ ì¡´ì¬ë¥¼ ì•Œê³ ë‚œ ë’¤, 'í•´ë³¼ë§Œ í•˜ê² ë‹¤'ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.

íšŒì‚¬ì—ì„œ ë‹¹ì¥ ì‚¬ìš©í•  ìˆœ ì—†ì—ˆë‹¤.
ë‹¹ì‹œ í”„ë¡œë•íŠ¸ ë…¸ë“œ ë²„ì „ì€ 14.17.0ë²„ì „ì´ì—ˆê³ , orvalì€ ìµœì†Œ 16ì´ìƒì´ì—ˆë˜ ê±¸ë¡œ ê¸°ì–µí•œë‹¤

ê¼­ Orvalë§Œì„ ìœ„í•´ ë…¸ë“œë²„ì „ì„ ì˜¬ë¦¬ìê³  ì£¼ì¥í–ˆë˜ ê²ƒì€ ì•„ë‹ˆì—ˆì§€ë§Œ, ìµœì†Œ 20ë²„ì „ì´ìƒ ì˜¬ë¦¬ê³  ì‹¶ë‹¤ê³  íŒ€ì¥ê³¼ì˜ ë©´ë‹´ì´ë‚˜, íšŒì˜ ë•Œ íŒ€ì›ì—ê²Œ ê³µìœ ë“œë¦¬ê³¤ í–ˆë‹¤.
ê·¸ë¦¬ê³  ì‘ë…„ í•˜ë°˜ê¸°ë¥¼ ê¸°ì ìœ¼ë¡œ ë…¸ë“œë²„ì „ì„ 20.17.0 ë²„ì „ìœ¼ë¡œ ì˜¬ë ¸ë‹¤.

í˜„ì¬ Orvalì„ ì§„ì§€í•˜ê²Œ ê²€í† í•˜ê³  ìˆìœ¼ë©°, í”„ë¡œë•íŠ¸ì— ë°˜ì˜í•˜ê¸° ì „ì— ë‚´ê°€ ì¢€ ë” ë””í…Œì¼í•˜ê²Œ ì‚¬ìš©í•´ë³´ê³  ì‹¶ì–´ì„œ ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì³ë³´ë ¤ê³  í•œë‹¤.

### Orvalì´ë€?

> Orvalì€ openAPI ëª…ì„¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Typescript modelì„ ìë™ ìƒì„±í•´ì£¼ëŠ” ë„êµ¬ì´ë‹¤.

ì˜ˆë¥¼ë“¤ì–´ ìƒˆë¡œìš´ APIë¥¼ ì„œë²„ê°œë°œìê°€ ë§Œë“¤ì–´ì¤¬ë‹¤. ê·¸ëŸ¼ ë‚˜ëŠ” ì´ APIì˜ íƒ€ì…ì„ ì…í˜€ì„œ mockup ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³ , MSWë¥¼ í†µí•´ ê°œë°œì„ ì§„í–‰í•  ê²ƒì´ë‹¤.
ì—¬ê¸°ì„œ ì„¸ë¶„í™” ì‹œì¼œë³´ë©´, ë‚˜ì˜ ì‘ì—…ê³µìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- API íƒ€ì…ì„ chatGPTì— ë¶™ì—¬ë„£ê³  ìƒì„±í•´ë‹¬ë¼ê³  í•œ ë’¤ ë³µë¶™.
- mockup ë°ì´í„°ë„ ìƒì„±í•´ë‹¬ë¼ê³  í•œ ë’¤ ë³µë¶™.
- MSWë¥¼ í†µí•´ APIë¥¼ í˜¸ì¶œí•´ë³´ê³  ê·¸ë ¤ì§„ í™”ë©´ì„ ë³´ë©° ì˜¤ë¥˜ëŠ” ì—†ëŠ”ì§€ í™•ì¸.

í•˜ì§€ë§Œ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ìˆ˜ì •ì‚¬í•­ì´ ìƒê¸´ë‹¤.
ì–´ëŠë‚  ì„œë²„ê°œë°œìê°€ ìˆ˜ì •ì‚¬í•­ì´ ìƒê²¼ë‹¤ê³  í•´ë‹¹ ë¶€ë¶„ì„ ìˆ˜ì •í•´ë‹¬ë¼ê³  ìš”ì²­í–ˆë‹¤.
ë‚˜ëŠ” ìƒì„±ëœ íƒ€ì…ë„ ìˆ˜ì •í•´ì•¼í•˜ê³ , mockup dataë„ ìˆ˜ì •í•˜ê³ , MSWë¥¼ í†µí•´ ìˆ˜ì •ëœ ë¶€ë¶„ì´ ì˜ ë°˜ì˜ë˜ì—ˆëŠ”ì§€ í™•ì¸ë„ í•´ì•¼í•œë‹¤.
ì´ ì‘ì—…ì´ 2~3ë²ˆë§Œ ë°˜ë³µëœë‹¤ë©´ ë²Œì¨ë¶€í„° í”¼ê³¤í•˜ë‹¤.. ğŸ¥²

Orvalì„ ì‚¬ìš©í•œë‹¤ë©´ ì´ë¥¼ ê°œì„ í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.

---

### ì‚¬ì „ ì¤€ë¹„

ë¨¼ì €, Orval ê³µì‹ë¬¸ì„œì—ì„œ ì œê³µí•´ì£¼ëŠ” ì˜ˆì œì™€ ë™ì¼í•œ [petstore swagger](https://petstore3.swagger.io/#/pet/addPet)ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.
baseURLì„ ë“±ë¡í•´ì„œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ë‚˜ì˜ ê²½ìš°ëŠ” jsonê³¼ yamlíŒŒì¼ë¡œ ê°ê° ë™ì¼í•˜ê²Œ ë§Œë“¤ì–´ì„œ ì ìš©í•´ë´¤ë‹¤.

<SideNote>
  í´ë¦­í•´ì„œ jsonìœ¼ë¡œ ë°›ê±°ë‚˜,
  <br /> swagger editorë¥¼ í†µí•´ yamlë¡œ ë³€í™˜í–ˆë‹¤
</SideNote>
![](./swagger-json.png)

### schema

ë¨¼ì € type schemaë¶€í„° ë§Œë“¤ì–´ë³´ì.

`orval.config.ts` ì‘ì„±

```js
// orval.config.ts
import { defineConfig } from "orval";

export default defineConfig({
  petstore: {
    output: {
      mode: "tags-split", // íƒœê·¸ë³„ë¡œ ë¶„ë¦¬
      target: "./src/api/petstore.ts", // ìƒì„±ë  íŒŒì¼ ê²½ë¡œ
      schemas: "./src/api/models", // ìƒì„±ë  ëª¨ë¸ ê²½ë¡œ
      client: "fetch", // ì‚¬ìš©í•  í´ë¼ì´ì–¸íŠ¸
    },
    input: {
      target: "./petstore.yaml", // ì°¸ê³ í•  swagger íŒŒì¼ ê²½ë¡œ
      filters: {
        tags: [/store/], // tag í•„í„° â†’ "store"ì™€ ê°™ì´ stringìœ¼ë¡œ ì‘ì„±í•˜ë©´ í•„í„° ì•ˆê±¸ë¦¼.
      },
    },
  },
});
```

```bash
npx orval
```

![](./npm-run-gen.png)
ëª…ë ¹ì–´ë¥¼ ì…ë ¥ í›„, Orval íŒŒì¼ì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
filterë¥¼ ë°˜ì˜í•´ì„œ storeë§Œ ìƒì„±ë˜ì—ˆë‹¤.

---

### transformer

![](./want-null.png)
ìƒì„±ëœ modelì„ í™•ì¸í•˜ë‹¤ê°€ ìˆ˜ì •í•˜ê³  ì‹¶ì€ ë¶€ë¶„ì´ ìƒê²¼ë‹¤.  
`void`ê°€ ì•„ë‹ˆë¼ `null`ì´ë‚˜ `undefined`ì´ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤.

```js
// orval.config.ts
import { defineConfig } from "orval";
import type { GeneratorVerbOptions } from "@orval/core";

export default defineConfig({
  petstore: {
    output: {
      mode: "tags-split", // split
      target: "./src/api/petstore.ts",
      schemas: "./src/api/models",
      client: "fetch",
      override: {
        // here! ğŸ™‹â€â™‚ï¸
        transformer: (verb: GeneratorVerbOptions): GeneratorVerbOptions => {
          if (verb.response?.definition) {
            const definition = verb.response.definition;
            console.log("definition", definition);
          }
          return verb;
        },
      },
    },
    input: {
      target: "./petstore.yaml",

      filters: {
        tags: [/store/],
      },
    },
  },
});
```

![](./error-null.png)

ë¨¼ì € voidê°€ ëœ¨ëŠ” ì›ì¸ì„ ì‚´í´ë³´ë©´, definition ì— contentê°€ ì—†ì„ ê²½ìš° Orvalì—ì„  voidë¡œ ì •ì˜í•œë‹¤.
ì´ë¥¼ ìˆ˜ì •í•´ì„œ schemaë¥¼ ìƒì„±í•˜ë ¤ë©´ transformerë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```js {12-20}
// orval.config.ts
import type { GeneratorVerbOptions } from "@orval/core";
import { defineConfig } from "orval";

export default defineConfig({
  petstore: {
    output: {
      mode: "tags-split", // split
      target: "./src/api/petstore.ts",
      schemas: "./src/api/models",
      client: "fetch",
      override: {
        // here! ğŸ™‹â€â™‚ï¸
        transformer: (verb: GeneratorVerbOptions): GeneratorVerbOptions => {
          if (verb.response?.definition.errors === "void") {
            verb.response.definition.errors = "null";
          }

          return verb;
        },
      },
    },
    input: {
      target: "./petstore.yaml",

      filters: {
        tags: [/store/],
      },
    },
  },
});
```

![](./change-void-to-null.png)

nullë¡œ ì˜ ë³€ê²½ë˜ì—ˆë‹¤.

---

### custom fetch

custom fetchë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ `mutator`ë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤.

```js {21-25}
// orval.config.ts
import type { GeneratorVerbOptions } from "@orval/core";
import { defineConfig } from "orval";

export default defineConfig({
  petstore: {
    output: {
      mode: "tags-split", // split
      target: "./src/api/petstore.ts",
      schemas: "./src/api/models",
      client: "fetch",
      override: {
        transformer: (verb: GeneratorVerbOptions): GeneratorVerbOptions => {
          if (verb.response?.definition.errors === "void") {
            verb.response.definition.errors = "null";
          }

          return verb;
        },

        // here! ğŸ™‹â€â™‚ï¸
        mutator: {
          path: "./src/api/http-client.ts",
          name: "customFetch",
        },
      },
    },
    input: {
      target: "./petstore.yaml",

      filters: {
        tags: [/store/],
      },
    },
  },
});
```

ì°¸ê³ ë¡œ mutatorì˜ **nameì€ í•´ë‹¹ ê²½ë¡œì— í¬í•¨ëœ í•¨ìˆ˜ì˜ ëª…ì¹­ê³¼ ì¼ì¹˜**í•´ì•¼í•œë‹¤.
[ê³µì‹ë¬¸ì„œ](https://github.com/orval-labs/orval/blob/master/samples/next-app-with-fetch/custom-fetch.ts)ì—ì„œ ì œê³µí•˜ëŠ” ë°©ë²•ëŒ€ë¡œ ë°˜ì˜í–ˆì„ ë•Œ customFetchë¥¼ ìƒì„±í•  ìˆ˜ìˆë‹¤.

í•˜ì§€ë§Œ ë‚˜ì˜ ê²½ìš°ì—”, httpClientë¥¼ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ğŸ¥²
ë”°ë¡œ ì œê³µí•´ì£¼ëŠ” ë°©ë²•ì€ ì—†ëŠ” ë“¯í•˜ê³ , wrapperë¥¼ í•˜ë‚˜ ë‘ì–´ì„œ ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

```js
// http-client.ts
import { createUrl } from "./create-url";

export const httpClient = {
  get: async ({ url, options }: GetRequest): Promise<Response> => {
    const resolvedUrl = createUrl(url);
    const token = localStorage.getItem("AccessToken");
    const headers = {
      ...(options?.headers || {}),
      ...(token ? { Authorization: `Bearer ${token}` } : {}),
    };

    const response = await fetch(resolvedUrl, {
      ...options,
      method: "GET",
      headers,
    });

    return await checkResponse(response);
  },
  // ..
};
```

```js
// customHttpClient.ts
type HttpMethod = 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE';

export const customHttpClient = async <T>(
  url: string,
  options: RequestInit & { method: HttpMethod },
): Promise<T> => {
  const { method, body, ...restOptions } = options;
  const lowerMethod = method.toLowerCase() as Lowercase<HttpMethod>;

  const args =
    body !== undefined
      ? { url, body, options: restOptions }
      : { url, options: restOptions };

  return httpClient[lowerMethod](args).then(async (response) => {
    const status = response.status;

    const text = [204, 205, 304].includes(status)
      ? null
      : await response.text();

    const data: T = text ? JSON.parse(text) : ({} as T);
    return data;
  });
};
```

---

###
